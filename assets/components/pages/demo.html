<html><head><script>function MakePromise(asap){function Promise(fn){if(typeof this!=="object"||typeof fn!=="function")throw new TypeError;this._state=null;this._value=null;this._deferreds=[];doResolve(fn,resolve.bind(this),reject.bind(this))}function handle(deferred){var me=this;if(this._state===null){this._deferreds.push(deferred);return}asap(function(){var cb=me._state?deferred.onFulfilled:deferred.onRejected;if(typeof cb!=="function"){(me._state?deferred.resolve:deferred.reject)(me._value);return}var ret;try{ret=cb(me._value)}catch(e){deferred.reject(e);return}deferred.resolve(ret)})}function resolve(newValue){try{if(newValue===this)throw new TypeError;if(newValue&&(typeof newValue==="object"||typeof newValue==="function")){var then=newValue.then;if(typeof then==="function"){doResolve(then.bind(newValue),resolve.bind(this),reject.bind(this));return}}this._state=true;this._value=newValue;finale.call(this)}catch(e){reject.call(this,e)}}function reject(newValue){this._state=false;this._value=newValue;finale.call(this)}function finale(){for(var i=0,len=this._deferreds.length;i<len;i++){handle.call(this,this._deferreds[i])}this._deferreds=null}function doResolve(fn,onFulfilled,onRejected){var done=false;try{fn(function(value){if(done)return;done=true;onFulfilled(value)},function(reason){if(done)return;done=true;onRejected(reason)})}catch(ex){if(done)return;done=true;onRejected(ex)}}Promise.prototype["catch"]=function(onRejected){return this.then(null,onRejected)};Promise.prototype.then=function(onFulfilled,onRejected){var me=this;return new Promise(function(resolve,reject){handle.call(me,{onFulfilled:onFulfilled,onRejected:onRejected,resolve:resolve,reject:reject})})};Promise.resolve=function(value){if(value&&typeof value==="object"&&value.constructor===Promise){return value}return new Promise(function(resolve){resolve(value)})};Promise.reject=function(value){return new Promise(function(resolve,reject){reject(value)})};return Promise}if(typeof module!=="undefined"){module.exports=MakePromise}</script><script>if(!window.Promise){window.Promise=MakePromise(Polymer.Base.async)}</script><script>"use strict";Polymer({is:"iron-request",properties:{xhr:{type:Object,notify:true,readOnly:true,value:function(){return new XMLHttpRequest}},response:{type:Object,notify:true,readOnly:true,value:function(){return null}},status:{type:Number,notify:true,readOnly:true,value:0},statusText:{type:String,notify:true,readOnly:true,value:""},completes:{type:Object,readOnly:true,notify:true,value:function(){return new Promise(function(resolve,reject){this.resolveCompletes=resolve;this.rejectCompletes=reject}.bind(this))}},progress:{type:Object,notify:true,readOnly:true,value:function(){return{}}},aborted:{type:Boolean,notify:true,readOnly:true,value:false}},get succeeded(){var status=this.xhr.status||0;return status===0||status>=200&&status<300},send:function(options){var xhr=this.xhr;if(xhr.readyState>0){return null}xhr.addEventListener("readystatechange",function(){if(xhr.readyState===4&&!this.aborted){this._updateStatus();if(!this.succeeded){this.rejectCompletes(new Error("The request failed with status code: "+this.xhr.status));return}this._setResponse(this.parseResponse());this.resolveCompletes(this)}}.bind(this));xhr.addEventListener("progress",function(progress){this._setProgress({lengthComputable:progress.lengthComputable,loaded:progress.loaded,total:progress.total})}.bind(this));xhr.addEventListener("error",function(error){this._updateStatus();this.rejectCompletes(error)}.bind(this));xhr.addEventListener("abort",function(){this._updateStatus();this.rejectCompletes(new Error("Request aborted."))}.bind(this));xhr.open(options.method||"GET",options.url,options.async!==false);if(options.headers){Object.keys(options.headers).forEach(function(requestHeader){xhr.setRequestHeader(requestHeader,options.headers[requestHeader])},this)}var contentType;if(options.headers){contentType=options.headers["Content-Type"]}var body=this._encodeBodyObject(options.body,contentType);xhr.responseType=xhr._responseType=options.handleAs||"text";xhr.withCredentials=!!options.withCredentials;xhr.send(body);return this.completes},parseResponse:function(){var xhr=this.xhr;var responseType=this.xhr.responseType||this.xhr._responseType;var preferResponseText=!this.xhr.responseType;try{switch(responseType){case"json":if(preferResponseText||xhr.response===undefined){try{xhr.responseText}catch(e){return xhr.response}if(xhr.responseText){return JSON.parse(xhr.responseText)}}return xhr.response;case"xml":return xhr.responseXML;case"blob":case"document":case"arraybuffer":return xhr.response;case"text":default:return xhr.responseText}}catch(e){this.rejectCompletes(new Error("Could not parse response. "+e.message))}},abort:function(){this._setAborted(true);this.xhr.abort()},_encodeBodyObject:function(body,contentType){if(typeof body=="string"){return body}switch(contentType){case"application/json":return JSON.stringify(body);case"application/x-www-form-urlencoded":return this._wwwFormUrlEncode(body)}return body},_wwwFormUrlEncode:function(object){if(!object){return""}var pieces=[];Object.keys(object).forEach(function(key){pieces.push(this._wwwFormUrlEncodePiece(key)+"="+this._wwwFormUrlEncodePiece(object[key]))},this);return pieces.join("&")},_wwwFormUrlEncodePiece:function(str){return encodeURIComponent(str.toString().replace(/\r?\n/g,"\r\n")).replace(/%20/g,"+")},_updateStatus:function(){this._setStatus(this.xhr.status);this._setStatusText(this.xhr.statusText===undefined?"":this.xhr.statusText)}});</script><script>"use strict";Polymer({is:"iron-ajax",properties:{url:{type:String,value:""},params:{type:Object,value:function(){return{}}},method:{type:String,value:"GET"},headers:{type:Object,value:function(){return{}}},contentType:{type:String,value:null},body:{type:Object,value:null},sync:{type:Boolean,value:false},handleAs:{type:String,value:"json"},withCredentials:{type:Boolean,value:false},auto:{type:Boolean,value:false},verbose:{type:Boolean,value:false},loading:{type:Boolean,notify:true,readOnly:true},lastRequest:{type:Object,notify:true,readOnly:true},lastResponse:{type:Object,notify:true,readOnly:true},lastError:{type:Object,notify:true,readOnly:true},activeRequests:{type:Array,notify:true,readOnly:true,value:function(){return[]}},debounceDuration:{type:Number,value:0,notify:true},_boundHandleResponse:{type:Function,value:function(){return this._handleResponse.bind(this)}}},observers:["_requestOptionsChanged(url, method, params, headers,"+"contentType, body, sync, handleAs, withCredentials, auto)"],get queryString(){var queryParts=[];var param;var value;for(param in this.params){value=this.params[param];param=window.encodeURIComponent(param);if(value!==null){param+="="+window.encodeURIComponent(value)}queryParts.push(param)}return queryParts.join("&")},get requestUrl(){var queryString=this.queryString;if(queryString){return this.url+"?"+queryString}return this.url},get requestHeaders(){var headers={};var contentType=this.contentType;if(contentType==null&&typeof this.body==="string"){contentType="application/x-www-form-urlencoded"}if(contentType){headers["Content-Type"]=contentType}var header;if(this.headers instanceof Object){for(header in this.headers){headers[header]=this.headers[header].toString()}}return headers},toRequestOptions:function(){return{url:this.requestUrl,method:this.method,headers:this.requestHeaders,body:this.body,async:!this.sync,handleAs:this.handleAs,withCredentials:this.withCredentials}},generateRequest:function(){var request=document.createElement("iron-request");var requestOptions=this.toRequestOptions();this.activeRequests.push(request);request.completes.then(this._boundHandleResponse).catch(this._handleError.bind(this,request)).then(this._discardRequest.bind(this,request));request.send(requestOptions);this._setLastRequest(request);this._setLoading(true);this.fire("request",{request:request,options:requestOptions});return request},_handleResponse:function(request){this._setLastResponse(request.response);this.fire("response",request)},_handleError:function(request,error){if(this.verbose){console.error(error)}this._setLastError({request:request,error:error});this.fire("error",{request:request,error:error})},_discardRequest:function(request){var requestIndex=this.activeRequests.indexOf(request);if(requestIndex>-1){this.activeRequests.splice(requestIndex,1)}if(this.activeRequests.length===0){this._setLoading(false)}},_requestOptionsChanged:function(){this.debounce("generate-request",function(){if(!this.url&&this.url!==""){return}if(this.auto){this.generateRequest()}},this.debounceDuration)}});</script><style>	.form-element { display: block; box-sizing: border-box; border: 1px solid #ccc; position: relative; border-radius: 3px;	}	.form-element.invalid { border: 1px solid #cc0000; z-index: 1;	}	.form-element .tooltip { position: absolute; top: -50px; left: 0; right: 0; margin: 0 auto; opacity: 0; text-align: center; transition: opacity 0.1s ease-in, transform 0.1s ease-out;	}	.form-element .tooltip div { background-color: #000; color: #FFF; padding: 10px 15px; border-radius: 3px; display: inline-block; font-size: 13px;	}	.form-element.tooltip-active .tooltip { opacity: 0.9; transform: translate(0, -3px);	}	.form-element .tooltip div:after { top: 100%; left: 50%; border: solid transparent; content: " "; height: 0; width: 0; position: absolute; pointer-events: none; border-color: rgba(0, 0, 0, 0); border-top-color: #000000; border-width: 5px; margin-left: -5px; z-index: 1;	}	.grouped-form .form-element { border-radius: 0; margin-top: -1px;	}	.grouped-form .first-form-element { border-radius: 3px 3px 0 0; margin-top: 0;	}	.grouped-form .last-form-element { border-radius: 0 0 3px 3px; border-bottom-width: 1px;	}</style><script>Polymer.formBehaviour={is:"form-behaviour",valid:function(element){element.classList.add("valid");element.classList.remove("invalid")},invalid:function(element){element.classList.add("invalid");element.classList.remove("valid")},isValid:function(element){return element.classList.contains("valid")},activateTooltip:function(element){element.classList.add("tooltip-active");element.addEventListener("click",function handler(){element.classList.remove("tooltip-active");element.removeEventListener("click",handler)})}};</script><style>	.form-element label { position: absolute; top: 22px; left: 20px; font-family: GillSans; color: #bbb; z-index: 1;	}	.form-element.invalid label { color: #cc0000;	}	.form-element input { position: relative; display: block; width: calc(100% - 30px); font-size: 14px; border: none; background: transparent; font-family: GillSans; z-index: 1; padding: 22px 10px 16px 18px;	}	.form-element input:focus { outline: 0;	}	.form-element input::-webkit-input-placeholder { color: transparent; }	.form-element input:-moz-placeholder { color: transparent; }	.form-element input::-moz-placeholder { color: transparent; }	.form-element input:-ms-input-placeholder { color: transparent; }	.form-element input::-ms-clear { display: none; } .form-element .float-label { -webkit-transform: translate3d(-2px, -16px, 0) scale(0.7); -moz-transform: translate3d(-2px, -16px, 0) scale(0.7); -ms-transform: translate3d(-2px, -16px, 0) scale(0.7); transform: translate3d(-2px, -16px, 0) scale(0.7); -webkit-transform-origin: left top; -moz-transform-origin: left top; -ms-transform-origin: left top; transform-origin: left top; -webkit-transition: -webkit-transform 0.25s; -moz-transition: -moz-transform 0.25s; -ms-transition: -ms-transform 0.25s; transition: transform 0.25s;	}	.form-element input:focus + label { color: #000;	}	.form-element span { display: block; position: absolute; top: 20px; right: 10px; width: 25px; height: 25px;	}	</style><script>Polymer.inputBehaviour={is:"input-behaviour",valid:function(icon){icon.classList.add("icon-tick_black");icon.classList.remove("icon-cross_red")},invalid:function(icon){icon.classList.add("icon-cross_red");icon.classList.remove("icon-tick_black")},clearIcon:function(icon){icon.classList.remove("icon-tick_black");icon.classList.remove("icon-cross_red")},floatLabel:function(label){label.classList.add("float-label")},noFloatLabel:function(label){label.classList.remove("float-label")},validLabel:function(label,labelTxt){label.innerHTML=labelTxt},invalidLabel:function(label,labelTxt){label.innerHTML=labelTxt}};</script><style>	.form-element select { -webkit-appearance: none; -moz-appearance: none; -ms-appearance: none; appearance: none; border: none; font-family: GillSans; width: 100%; font-size: 15px; position: relative; z-index: 1; background: transparent; cursor: pointer; padding: 11px 10px 11px 18px;	}	.form-element select:focus { outline: 0;	}	.form-element select::-ms-expand { display: none; }	.form-element .icon-arrow_down-active { display: block; position: absolute; top: 9px; right: 10px;	}</style><script>Polymer.selectBehaviour={is:"select-behaviour",valid:function(container){container.classList.remove("invalid")},invalid:function(container){container.classList.add("invalid")}};</script></head><body><div hidden=""><dom-module id="nap-product-price"><style> :host { display: inline; } .product-price { display: inline; } .sale, .discount { color: #F00; } s { padding-right: 5px } .discount { padding-left: 5px; } </style><template><div class="product-price" itemprop="offers" itemscope="" itemtype="http://schema.org/Offer"><template is="dom-if" if="{{!price.original}}"><span class="currency" itemprop="priceCurrency" content$="{{_getCurrencyCode()}}">{{_getCurrencySymbol()}}</span><span class="full-price" itemprop="price" content$="{{_currentPrice(price)}}">{{_currentPrice(price)}}</span></template><template is="dom-if" if="{{price.original}}"><s><span>{{_getCurrencySymbol()}}</span><span class="full-price">{{_originalPrice(price)}}</span></s><span class="currency sale" itemprop="priceCurrency" content$="{{_getCurrencyCode()}}">{{_getCurrencySymbol()}}</span><span class="sale sale-price" itemprop="price" content$="{{_currentPrice(price)}}">{{_currentPrice(price)}}</span><template is="dom-if" if="{{price.discountPercent}}"><span class="discount">{{_discount(price)}}</span></template></template><content select="link"></content><link itemprop="itemCondition" href="https://schema.org/NewCondition"></div></template><script>Polymer({is:"nap-product-price",properties:{price:Object,copy:{type:Object,value:{en:{beforeDiscount:"",off:"OFF"},fr:{beforeDiscount:"-",off:""},de:{beforeDiscount:"-",off:""},zh:{beforeDiscount:"",off:"折扣"}}}},_currentPrice:function(price){return this._formatPrice(price.gross,price.divisor)},_originalPrice:function(price){return this._formatPrice(price.original.gross,price.divisor)},_getCurrencyCode:function(){return NAP.locale.currencyCode},_getCurrencySymbol:function(){return NAP.locale.currencySymbol},_formatPrice:function(amount,divisor){return priceString=Math.ceil(amount/divisor).toString().replace(/\d(?=(\d{3})+$)/g,"$&,")},_discount:function(price){return this.copy[NAP.locale.language].beforeDiscount+price.discountPercent+"% "+this.copy[NAP.locale.language].off}});</script></dom-module><dom-module id="nap-product"><style> :host { display: block; box-sizing: border-box; padding: 0 10px !important; font-family: GillSans; font-size: 14px; margin-bottom: 40px; text-align: left; } img { min-height: 150px; } .image { width: 100%; } .image:active { filter: brightness(90%); -webkit-filter: brightness(90%); -moz-filter: brightness(90%); -o-filter: brightness(90%); -ms-filter: brightness(90%); } .designer { text-transform: uppercase; margin-top: 20px; } .name { overflow: hidden; text-overflow: ellipsis; display: -webkit-box; line-height: 18px; height: 36px; -webkit-line-clamp: 2; -webkit-box-orient: vertical; margin: 10px 0; } .name.hidden{ display:none; } .name:empty{ display: none; } </style><template><a href="{{_productUrl(product.id)}}" data-feature$="{{product.feature}}"><img id="image" class="image" src="{{_imgUrl(product.id)}}" itemprop="image" on-mouseover="_hoverShot" on-mouseout="_indexShot"><meta itemprop="url" content$="{{_canonicalProductUrl(product.id)}}"><meta itemprop="productID" content="{{product.id}}"><div class="designer" itemprop="brand" itemscope="" itemtype="http://schema.org/Brand"><span itemprop="name">{{product.brand.name}}</span></div><div class$="{{_nameInvisible(product.nameInvisible)}}" itemprop="name">{{product.name}}</div><template is="dom-if" if="{{product.price}}"><nap-product-price price$="{{product.price}}"></nap-product-price></template></a><template is="dom-if" if="{{product.sku}}"><nap-add-to-bag-button skus$="{{_getSku(product.sku)}}"></nap-add-to-bag-button></template></template><script>Polymer({is:"nap-product",properties:{product:Object},hostAttributes:{itemtype:"http://schema.org/Product",itemscope:true},_imgUrl:function(pid){return"//cache.net-a-porter.com/images/products/"+pid+"/"+pid+"_in_l.jpg"},_canonicalProductUrl:function(pid){return"/product/"+pid},_nameInvisible:function(nameInvisible){if(nameInvisible){return"name hidden"}else{return"name"}},_productUrl:function(pid){return"/"+NAP.locale.country.toLowerCase()+"/"+NAP.locale.language+"/product/"+pid},_indexShot:function(){if(!document.documentElement.classList.contains("touch")){this.$.image.src=this.$.image.src.replace(/ou_(.*)\.jpg/,"in_$1.jpg")}},_hoverShot:function(){if(!document.documentElement.classList.contains("touch")){this.$.image.src=this.$.image.src.replace(/in_(.*)\.jpg/,"ou_$1.jpg")}},_getSku:function(sku){return[sku]}});</script></dom-module><dom-module id="loading-spinner"><style> :host { display: inline-block; width: 20px; height: 20px; }; svg { width: 100%; height: 100%; -webkit-animation: spin 1s infinite linear; animation: spin 1s infinite linear; } @-webkit-keyframes spin { 0% { -webkit-transform: rotate(0deg); } 100% { -webkit-transform: rotate(360deg); } } @keyframes spin { 0% { -ms-transform: rotate(0deg); transform: rotate(0deg); } 100% { -ms-transform: rotate(360deg); transform: rotate(360deg); } } </style><template><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Layer_1" x="0px" y="0px" width="80px" height="80px" viewBox="0 0 80 80" enable-background="new 0 0 80 80" xml:space="preserve"><path fill="#CCCBCB" d="M74.597 48.391c0 0-1.773 12.504-12.14 20.99 -5.524 4.523-13.426 7.99-24.668 7.99 -10.336 0-31.654-8.795-31.654-38.195 0-10.697 9.891-31.222 31.654-31.222 20.334 0 31.873 15.295 31.873 29.802 -0.023 6.384 1.186 9.259 5.312 9.185 5.148 0 4.831-3.637 4.831-8.51 -0.067-6.994-3.5-19.75-13.859-28.671 -7.516-5.829-15.558-9.954-28.183-9.49 -10.041 0.787-17.959 4.12-25.75 11.62C5.039 18.825 0.764 27.932 0.285 38.557c0 13.333 4.688 21.875 10.454 28.404 6.899 7.387 16.191 12.055 26.899 12.805 11.417 0 19.881-4.01 25.824-9.34C71.278 63.418 74.511 53.836 74.597 48.391z"></path></svg></template><script>Polymer({is:"loading-spinner"});</script></dom-module><dom-module id="widget-show-hide"><style> @keyframes showHideExpand { 0% { max-height: 0; } 100% { max-height: 300px; } } @keyframes showHideCollapse { 0% { max-height: 300px; } 100% { max-height: 0; } } :host { display: block; position: relative; }; ::content .show-hide-title { height: 90px; line-height: 90px; text-align: center; cursor: pointer; text-transform: uppercase; } ::content .show-hide-content { max-height: 0; overflow: hidden; }; :host.transitioning ::content .show-hide-content { -moz-animation-name: showHideCollapse; -webkit-animation-name: showHideCollapse; animation-name: showHideCollapse; -moz-animation-duration: 0.5s; -webkit-animation-duration: 0.5s; animation-duration: 0.5s; -moz-animation-timing-function: ease-out; -webkit-animation-timing-function: ease-out; animation-timing-function: ease-out; }; :host.open ::content .show-hide-content { max-height: 3000px; }; :host.open.transitioning ::content .show-hide-content { -moz-animation-name: showHideExpand; -webkit-animation-name: showHideExpand; animation-name: showHideExpand; -moz-animation-duration: 0.5s; -webkit-animation-duration: 0.5s; animation-duration: 0.5s; -moz-animation-timing-function: ease-in; -webkit-animation-timing-function: ease-in; animation-timing-function: ease-in; } .icon { position: absolute; right: 12px; top: 32px; z-index: -1; } @media (min-width: 951px) { :host.open-lg ::content .show-hide-title { cursor: auto; } :host.open-lg ::content .show-hide-content { max-height: none; }; :host.open-lg .icon { display: none; } } </style><template><div class="icon icon-plus" on-click="_onClick"></div><content></content></template><script>Polymer({is:"widget-show-hide",properties:{open:{type:Boolean,value:false},name:String},ready:function(){if(this.open){this.toggle()}var title=this.querySelector(".show-hide-title");var self=this;if(title){title.addEventListener("click",function(){self._onClick()})}var content=this.querySelector(".show-hide-content");content.addEventListener("animationend",function(){self.classList.remove("transitioning")})},_onClick:function(){var isOpen=this.toggle();if(isOpen){this.fire("open")}else{this.fire("close")}},toggle:function(){var self=this;var icon=this.querySelector(".icon");this.classList.add("transitioning");var isOpen=this.classList.toggle("open");icon.classList.toggle("icon-plus");icon.classList.toggle("icon-minus");return isOpen},getName:function(){return this.name}});</script></dom-module><dom-module id="input-email"><template><template is="dom-if" if="{{tooltip}}"><div class="tooltip"><div>{{tooltip}}</div></div></template><input id="input" name="{{name}}" type="email" placeholder="{{label}}" on-focus="_onFocus" on-blur="_onBlur" value="{{value}}"><label for="input">{{label}}</label><span></span></template><script>Polymer({is:"input-email",properties:{name:String,required:Boolean,linked:String,label:String,error:String,tooltip:String,value:String},ready:function(){this.classList.add("form-element");this.inputEl=this.querySelector("input");this.labelEl=this.querySelector("label");this.iconEl=this.querySelector("span");if(this.value){Polymer.inputBehaviour.floatLabel(this.labelEl)}if(this.linked){var _this=this;this.primaryEmailEl=document.getElementById(this.linked);this.primaryEmailEl.getElementsByTagName("input")[0].addEventListener("change",function(){_this._linkedValidate()})}},listeners:{input:"_onInput"},_onInput:function(e){if(this.required===true){this.validState=this.validate(this.inputEl.value);if(this.validState){Polymer.formBehaviour.valid(this);Polymer.inputBehaviour.valid(this.iconEl);Polymer.inputBehaviour.validLabel(this.labelEl,this.label)}}if(this.linked){if(this.primaryEmailEl.getValue()===this.inputEl.value){this.validState=true;this._setValidState()}}},_onFocus:function(){Polymer.inputBehaviour.floatLabel(this.labelEl);Polymer.inputBehaviour.validLabel(this.labelEl,this.label)},_onBlur:function(){if(this.required===true){if(this.validState){this._setValidState()}else{this._setInvalidState()}}if(this.linked&&this.inputEl.value!==""){this._linkedValidate()}if(this.inputEl.value===""){Polymer.inputBehaviour.noFloatLabel(this.labelEl)}},_setValidState:function(){Polymer.formBehaviour.valid(this);Polymer.inputBehaviour.valid(this.iconEl);Polymer.inputBehaviour.validLabel(this.labelEl,this.label)},_setInvalidState:function(){Polymer.formBehaviour.invalid(this);Polymer.inputBehaviour.invalid(this.iconEl);Polymer.inputBehaviour.invalidLabel(this.labelEl,this.error)},_linkedValidate:function(){if(this.inputEl.Value!==""&&this.primaryEmailEl.getValue()===this.inputEl.value){this.validState=true;this._setValidState()}else{this.validState=false;if(this.inputEl.value!==""){this._setInvalidState()}}},validate:function(value){if(/^[a-z0-9!#$%&'*+\/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+\/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i.test(value)){return true}return false},getValue:function(){return this.$.input.value},isValid:function(){return Polymer.formBehaviour.isValid(this)},activateTooltip:function(){return Polymer.formBehaviour.activateTooltip(this)}});</script></dom-module><dom-module id="input-telephone"><template><template is="dom-if" if="{{tooltip}}"><div class="tooltip"><div>{{tooltip}}</div></div></template><input id="input" name="{{name}}" type="tel" placeholder="{{label}}" on-focus="_onFocus" on-blur="_onBlur" value="{{value}}"><label for="input">{{label}}</label><span></span></template><script>Polymer({is:"input-telephone",properties:{name:String,required:Boolean,label:String,error:String,tooltip:String,value:String},ready:function(){this.classList.add("form-element");this.inputEl=this.querySelector("input");this.labelEl=this.querySelector("label");this.iconEl=this.querySelector("span");if(this.value){Polymer.inputBehaviour.floatLabel(this.labelEl)}},listeners:{input:"_onInput"},_onInput:function(e){if(this.required===true){this.validState=this.validate(this.inputEl.value);if(this.validState){Polymer.formBehaviour.valid(this);Polymer.inputBehaviour.valid(this.iconEl);Polymer.inputBehaviour.validLabel(this.labelEl,this.label)}}},_onFocus:function(){Polymer.inputBehaviour.floatLabel(this.labelEl);Polymer.inputBehaviour.validLabel(this.labelEl,this.label)},_onBlur:function(){if(this.required===true){if(this.validState){Polymer.formBehaviour.valid(this);Polymer.inputBehaviour.valid(this.iconEl);Polymer.inputBehaviour.validLabel(this.labelEl,this.label)}else{Polymer.formBehaviour.invalid(this);Polymer.inputBehaviour.invalid(this.iconEl);Polymer.inputBehaviour.invalidLabel(this.labelEl,this.error)}}if(this.inputEl.value===""){Polymer.inputBehaviour.noFloatLabel(this.labelEl)}},validate:function(value){if(/^\+?[\d\s]+$/.test(value)){return true}return false},getValue:function(){return this.$.input.value},isValid:function(){return Polymer.formBehaviour.isValid(this)},activateTooltip:function(){return Polymer.formBehaviour.activateTooltip(this)}});</script></dom-module><dom-module id="input-text"><template><template is="dom-if" if="{{tooltip}}"><div class="tooltip"><div>{{tooltip}}</div></div></template><input id="input" name="{{name}}" type="{{type}}" placeholder="{{label}}" on-focus="_onFocus" on-blur="_onBlur" value="{{value}}"><label for="input">{{label}}</label><span></span></template><script>Polymer({is:"input-text",properties:{name:String,type:String,required:Boolean,label:String,error:String,tooltip:String,value:String},ready:function(){this.classList.add("form-element");this.inputEl=this.querySelector("input");this.labelEl=this.querySelector("label");this.iconEl=this.querySelector("span");if(this.value){Polymer.inputBehaviour.floatLabel(this.labelEl)}},listeners:{input:"_onInput"},_onInput:function(e){this.validState=this.validate(this.inputEl.value);if(this.validState){Polymer.formBehaviour.valid(this);Polymer.inputBehaviour.valid(this.iconEl);Polymer.inputBehaviour.validLabel(this.labelEl,this.label)}else{Polymer.formBehaviour.invalid(this);Polymer.inputBehaviour.clearIcon(this.iconEl)}},_onFocus:function(){Polymer.inputBehaviour.floatLabel(this.labelEl);Polymer.inputBehaviour.validLabel(this.labelEl,this.label)},_onBlur:function(){if(this.required===true){if(this.validState){Polymer.formBehaviour.valid(this);Polymer.inputBehaviour.valid(this.iconEl);Polymer.inputBehaviour.validLabel(this.labelEl,this.label)}else{Polymer.formBehaviour.invalid(this);Polymer.inputBehaviour.invalid(this.iconEl);Polymer.inputBehaviour.invalidLabel(this.labelEl,this.error)}}if(this.inputEl.value===""){Polymer.inputBehaviour.noFloatLabel(this.labelEl)}},validate:function(value){if(value!==""){return true}return false},getValue:function(){return this.$.input.value},isValid:function(){return Polymer.formBehaviour.isValid(this)},activateTooltip:function(){return Polymer.formBehaviour.activateTooltip(this)}});</script></dom-module><dom-module id="select-country"><template><iron-ajax id="getCountries" auto="" url="{{_getUrl()}}" handle-as="json" last-response="{{countryApiResponse}}" last-error="{{countryApiError}}" on-request="_onRequest" on-response="_onResponse" on-error="_onError"></iron-ajax><template is="dom-if" if="{{tooltip}}"><div class="tooltip"><div>{{tooltip}}</div></div></template><select id="{{name}}" name="{{name}}" on-blur="_onChange" on-change="_onChange"><option value="-">{{label}}</option></select><span class="icon-arrow_down-active"></span></template><script>Polymer({is:"select-country",properties:{name:String,required:Boolean,label:String,tooltip:String},_onRequest:function(){NAP.monitoring.registerPerfMark(this.$.getCountries.url)},_onResponse:function(){this._setOptions(this.countryApiResponse);NAP.monitoring.measurePerfMark("Polymer",this.$.getCountries.url,{status:"success"})},_onError:function(){NAP.monitoring.registerPerfMetricAndMonitoring("Polymer","API Failure",this.$.getCountries.url,{status:"error",errorThrown:this.countryApiError.error.message})},ready:function(){this.classList.add("form-element");this.selectEl=this.querySelector("select")},_setOptions:function(countryData){var sortedData=this._sortCountries(countryData);var selectEl=this.getElementsByTagName("select")[0];sortedData.forEach(function(item){var option=document.createElement("option");option.textContent=item.name;option.value=item.iso;selectEl.appendChild(option)})},_getUrl:function(){return"//nap-locale-info.nap-live.ext.net-a-porter.com/countries/1/"+NAP.locale.language+"/countries.json"},_onChange:function(){if(this.required===true){this.validState=this.validate(this.selectEl.value);if(this.validState){Polymer.formBehaviour.valid(this)}else{Polymer.formBehaviour.invalid(this)}}},validate:function(value){if(value!=="-"){return true}return false},_sortCountries:function(countryData){return Object.keys(countryData).map(function(iso){return{iso:iso,name:countryData[iso].name}}).sort(function(c1,c2){return c1.name.localeCompare(c2.name)})},getValue:function(){var select=this.$.select;return select.options[select.selectedIndex].value},isValid:function(){return Polymer.formBehaviour.isValid(this)},activateTooltip:function(){return Polymer.formBehaviour.activateTooltip(this)}});</script></dom-module><dom-module id="select-dropdown"><template><template is="dom-if" if="{{tooltip}}"><div class="tooltip"><div>{{tooltip}}</div></div></template><select id="select" name="{{name}}" on-blur="_onChange" on-change="_onChange"><option value="-">{{label}}</option></select><span class="icon-arrow_down-active"></span></template><script>Polymer({is:"select-dropdown",properties:{name:String,required:Boolean,label:String,options:Array,tooltip:String},ready:function(){this.classList.add("form-element");this.selectEl=this.querySelector("select");this._setOptions()},_setOptions:function(){var selectEl=this.getElementsByTagName("select")[0];this.options.forEach(function(item){var option=document.createElement("option");option.textContent=item.name;option.value=item.value;for(var key in item.data){option.setAttribute("data-"+key,item.data[key])}selectEl.appendChild(option)})},_onChange:function(){this.validState=this.validate()},validate:function(){if(this.selectEl.value!=="-"){Polymer.formBehaviour.valid(this)}else{if(this.required===true){Polymer.formBehaviour.invalid(this)}}},setInvalid:function(){Polymer.formBehaviour.invalid(this)},setValid:function(){Polymer.formBehaviour.valid(this)},getValue:function(){var select=this.$.select;return select.options[select.selectedIndex].value},getData:function(key){var select=this.$.select;return select.options[select.selectedIndex].getAttribute("data-"+key)},isValid:function(){return Polymer.formBehaviour.isValid(this)},activateTooltip:function(){return Polymer.formBehaviour.activateTooltip(this)}});</script></dom-module><dom-module id="textarea-field"><style> label { position: absolute; top: 22px; left: 20px; font-family: GillSans; color: #bbb; z-index: 0; } label.hidden { visibility: hidden; } :host.invalid label { color: #cc0000; } textarea { width: 100%; font-size: 15px; border: none; font-family: GillSans; outline: none; background: transparent; position: relative; z-index: 1; overflow: auto; }	</style><template><template is="dom-if" if="{{tooltip}}"><div class="tooltip"><div>{{tooltip}}</div></div></template><label for="textarea">{{label}}</label><textarea id="textarea" name="{{name}}" on-blur="_onBlur" rows="{{rows}}" value="{{value}}"></textarea></template><script>Polymer({is:"textarea-field",properties:{name:String,label:String,rows:Number,required:Boolean,tooltip:String,value:String},ready:function(){this.classList.add("form-element");this.textAreaEl=this.querySelector("textarea");this.labelEl=this.querySelector("label");if(this.value){Polymer.inputBehaviour.floatLabel(this.labelEl)}},listeners:{input:"_onInput"},_onInput:function(e){if(this.required===true){this.validState=this.validate(this.textAreaEl.value);if(this.validState){Polymer.formBehaviour.valid(this);this.labelEl.classList.add("hidden")}else{Polymer.formBehaviour.invalid(this);this.labelEl.classList.remove("hidden")}}},_onBlur:function(){if(this.required===true){this.validState=this.validate(this.textAreaEl.value);if(this.validState){Polymer.formBehaviour.valid(this)}else{Polymer.formBehaviour.invalid(this)}}},validate:function(value){if(value!==""){return true}return false},getValue:function(){return this.$.textarea.value},isValid:function(){return Polymer.formBehaviour.isValid(this)},activateTooltip:function(){return Polymer.formBehaviour.activateTooltip(this)}});</script></dom-module><dom-module id="nap-live"><style> #nap-live{ text-align: center; max-width:950px; width:950px; margin:0 auto; } #nap-live .heading { display: block; margin: 25px auto 10px; max-width: 100%; } #nap-live .sub-title{ line-height: 32px; color: #333; } #nap-live .user-sessions { display: inline-block; border-bottom: 1px solid #666; text-transform: uppercase; color: #666; padding-bottom: 5px; } #nap-live .user-sessions span { font-size: 13px; letter-spacing: 2px; } #nap-live .sell{ font-family: ModernNAP-Display; margin: 15px 0 25px; font-size: 17px; font-style: italic; } @media only screen and (max-width: 480px) { .sell{ font-family: GillSans, "Gill Sans MT", Calibri, sans-serif; padding:0 20px; } } #nap-live { overflow: hidden; height:480px; } </style><template><div id="nap-live"><img class="heading" src="//www.net-a-porter.com/alfresco/nap/webAssets/webPage/homepage-rebuild/components/images/logo.png"><div class="user-sessions"><nap-live-sessions></nap-live-sessions><span>{{_translate(copy, 'shoppers_online')}}</span></div><div class="sell">{{_translate(copy, 'what_women_buying')}}</div><nap-live-products></nap-live-products></div></template><script>Polymer({is:"nap-live",properties:{copy:{type:Object,value:{en:{shoppers_online:"Shoppers online",what_women_buying:"Showcasing what the world's most stylish women are buying right now"},de:{shoppers_online:"Shoppers online",what_women_buying:"Was die stylishsten Frauen der Welt jetzt kaufen"},fr:{shoppers_online:"visiteurs en ligne",what_women_buying:"Ce que les femmes les plus élégantes au monde achètent à cet instant"},zh:{shoppers_online:"位时尚爱好者在线",what_women_buying:"同步了解全球时尚女性正在购买的抢手单品"}}}},_translate:function(copy,key){return copy[NAP.locale.language][key]}});</script></dom-module><dom-module id="nap-live-sessions"><style> .user-count { display: inline; } .user-count span { font-size: 13px; letter-spacing: 2px; } #session-count { padding-right: 5px } </style><template><iron-ajax id="getSessions" auto="" url="/webapi/feed/sessioncount/NAP.json" handle-as="json" last-response="{{sessionsApiResponse}}" last-error="{{sessionsApiError}}" on-request="_onRequest" on-response="_onResponse" on-error="_onError"></iron-ajax><div class="user-count"><span id="session-count">{{userSessions}}</span></div></template><script>var errorTimerMultipler=1;var errorRefreshTimerMaximum=3e5;var refreshSessionsTimer=6e4;Polymer({is:"nap-live-sessions",properties:{userSessions:{type:Number,value:0}},_onRequest:function(){NAP.monitoring.registerPerfMark(this.$.getSessions.url)},_onResponse:function(){if(this.sessionsApiResponse&&this.sessionsApiResponse.sessioncount){this.userSessions=this.sessionsApiResponse.sessioncount;this.async(function(){this.$.getSessions.generateRequest();errorTimerMultipler=1},refreshSessionsTimer);NAP.monitoring.measurePerfMark("Polymer",this.$.getSessions.url,{status:"success"})}else{this._onError()}},_onError:function(){var errorTimerMultiplied=refreshSessionsTimer*errorTimerMultipler;var errorThrown;this.userSessions=this.userSessions>0?this.userSessions:31337;this.async(function(){this.$.getSessions.generateRequest()},errorTimerMultiplied);if(errorTimerMultiplied<errorRefreshTimerMaximum){errorTimerMultipler=errorTimerMultipler*2}if(this.sessionsApiError){errorThrown=this.sessionsApiError.error.message}else{errorThrown="sessions response empty"}NAP.monitoring.registerPerfMetricAndMonitoring("Polymer","API Failure",this.$.getSessions.url,{url:this.$.getSessions.url,status:"error",errorThrown:errorThrown})}});</script></dom-module><dom-module id="nap-live-product-activity"><style> .activity{ font-family: ModernNAP-Display; color:#333; margin: 5px 0; font-style: italic; } .locale span{ font-size:12px; white-space: nowrap; display: inline-block; } .city{ border-right: 1px solid #cbcbcb; margin-right: 3px; padding-right: 6px; } </style><template><div class="activity">{{_translate(copy, activity.type)}}</div><div class="locale"><template is="dom-if" if="{{activity.locale.city}}"><span class="city">{{activity.locale.city}}</span></template><span class="country">{{activity.locale.country}}</span></div></template><script>Polymer({is:"nap-live-product-activity",properties:{activity:Object,copy:{type:Object,value:{en:{tell_a_friend:"Tell a friend",share:"Shared",add_to_wishlist:"Added to wishlist",add_to_basket:"Added to basket"},de:{tell_a_friend:"Weiterempfehlen",share:"Teilen",add_to_wishlist:"Zur Wunschliste hinzugefügt",add_to_basket:"Zum Warenkorb hinzugefügt"},fr:{tell_a_friend:"Voir les détails",share:"Partager",add_to_wishlist:"Ajouté à ma wish list",add_to_basket:"Ajouté au panier"},zh:{tell_a_friend:"与好友分享",share:"分享",add_to_wishlist:"已加入愿望清单",add_to_basket:"已加入购物袋"}}}},_translate:function(copy,key){return copy[NAP.locale.language][key.toLowerCase()]}});</script></dom-module><dom-module id="nap-live-products"><style> :host { overflow:hidden; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; -o-user-select: none; user-select: none; } .row { -webkit-flex-wrap: inherit; -ms-flex-wrap: inherit; flex-wrap: inherit; margin-right: 0; margin-left: 0; } .swiper-prev, .swiper-next { display: block; position: absolute; z-index: 2; top: calc(50% - 25px); cursor: pointer; } .swiper-next { right: 0; } .swiper-button-disabled { display: none; } .swiper-container { position: relative; } nap-product ::shadow{ margin-bottom: 0; position: relative; text-align: center; } nap-product ::shadow .name{ font-family: ModernNAP-Display; text-transform: uppercase; } nap-product ::shadow .designer { overflow: hidden; text-overflow: ellipsis; display: -webkit-box; line-height: 18px; height: 36px; -webkit-line-clamp: 2; -webkit-box-orient: vertical; } @media only screen and (max-width: 480px) { nap-live-product-activity ::shadow .nap-live-product-activity { font-family: GillSans, "Gill Sans MT", Calibri, sans-serif; } } </style><template><iron-ajax id="getProduct" auto="" url="/webapi/feed/productactivity.json" params="{{_generateParams(size)}}" handle-as="json" last-response="{{productActivityApiResponse}}" last-error="{{productActivityApiError}}" on-request="_onRequest" on-response="_onResponse" on-error="_onError"></iron-ajax><div id="naplive-carousel" class="swiper-container"><div class="icon icon-arrow_left swiper-prev"></div><div class="swiper-wrapper row"><template is="dom-repeat" items="{{uniqueProductsArr}}"><div class="col-xs-6 col-sm-4 col-lg-2 swiper-slide"><nap-product product$="{{item}}" itemprop$="{{schemaproperty}}"></nap-product><nap-live-product-activity activity$="{{item.activity}}"></nap-live-product-activity></div></template></div><div class="icon icon-arrow_right swiper-next"></div></div></template><script>var errorTimerMultipler=1;var errorRefreshTimerMaximum=6e4;var refreshProductsTimer=1e4;Polymer({is:"nap-live-products",properties:{size:{type:Number,value:12},uniqueProductsArr:{type:Array,value:[]},carousel:{type:Boolean,value:false},carouselInstance:Object},_callAPI:function(){this.$.getProduct.generateRequest();errorTimerMultipler=1},_generateParams:function(size){return{channel:"NAP_"+NAP.locale.channel.toUpperCase(),size:size}},_onRequest:function(){NAP.monitoring.registerPerfMark(this.$.getProduct.url)},_onResponse:function(){if(this.productActivityApiResponse&&this.productActivityApiResponse.productactivity){this._updateProducts(this.productActivityApiResponse);this.async(this._callAPI,refreshProductsTimer);NAP.monitoring.measurePerfMark("Polymer",this.$.getProduct.url,{status:"success"});this._initCarousel()}else{this._onError()}},_onError:function(){var errorTimerMultiplied=refreshProductsTimer*errorTimerMultipler;var errorThrown;this.async(function(){this.$.getProduct.generateRequest()},errorTimerMultiplied);if(errorTimerMultiplied<errorRefreshTimerMaximum){errorTimerMultipler=errorTimerMultipler*2}if(this.productActivityApiError){errorThrown=this.productActivityApiError.error.message}else{errorThrown="product response empty"}NAP.monitoring.registerPerfMetricAndMonitoring("Polymer","API Failure",this.$.getProduct.url,{url:this.$.getProduct.url,status:"error",errorThrown:errorThrown})},_updateProducts:function(productActivityArr){var normalisedProductDataArr=this._normaliseProductData(productActivityArr);this._updateProductBuffer(normalisedProductDataArr)},_normaliseProductData:function(productActivityArr){var normalisedProductDataArr=[];productActivityArr.productactivity.forEach(function(productObj){normalisedProductDataArr.push({id:productObj.pid,brand:{name:productObj.designer},name:productObj.title,nameInvisible:true,feature:"NAP LIVE",activity:{hash:productObj.hash,activityCreated:productObj.activityCreated,type:productObj.activityType.toLowerCase(),locale:{city:productObj.city,country:productObj.country,latitude:productObj.latitude,longitude:productObj.longitude}}})});return normalisedProductDataArr},_updateProductBuffer:function(normalisedProductDataArr){var that=this;normalisedProductDataArr.forEach(function(normalisedProductObj){that._checkIfHashHasBeenUsedBefore(normalisedProductObj)})},_checkIfHashHasBeenUsedBefore:function(normalisedProductObj){var uniqueProductsArr=this.uniqueProductsArr;if(uniqueProductsArr.length>0){var hashAlreadyExists=false;uniqueProductsArr.forEach(function(uniqueProductObj){if(uniqueProductObj.activity.hash===normalisedProductObj.activity.hash){hashAlreadyExists=true}});if(!hashAlreadyExists){this._addUniqueProductsToArr(normalisedProductObj)}}else{this._addUniqueProductsToArr(normalisedProductObj)}},_addUniqueProductsToArr:function(normalisedProductObj){this.push("uniqueProductsArr",normalisedProductObj)},_initCarousel:function(){if(!this.carouselInstance){this.carouselInstance=new Swiper(this.$$("#naplive-carousel"),{nextButton:this.$$(".swiper-next"),prevButton:this.$$(".swiper-prev"),slidesPerView:6,simulateTouch:false,autoplay:4e3});if(this.carouselInstance.slides.length>8){this.carouselInstance.startAutoplay()}else{this.carouselInstance.stopAutoplay()}}else{this.carouselInstance.update();if(this.carouselInstance.slides.length>8&&!this.carouselInstance.autoplaying){this.carouselInstance.startAutoplay()}}},attached:function(){if(this.carousel&&this.pids.length>6){var orientation;var self=this;window.addEventListener("resize",function(){self._initCarousel()});window.addEventListener("deviceorientation",function(){switch(true){case NAP.device.portrait()&&orientation==="landscape":orientation="portrait";self._initCarousel();break;case NAP.device.landscape()&&orientation==="portrait":orientation="landscape";self._initCarousel();break}})}}});</script></dom-module><dom-module id="nap-wishlist-button"><style> :host { display: block; position: relative; }; .wishlist-button { box-sizing: border-box; text-transform: uppercase; } .wishlist-button span, loading-spinner{ transition: opacity 0.3s ease-out; } loading-spinner, .successful-text { opacity: 0; position: absolute; margin: 0 auto; right: 0; left: 0; } loading-spinner { z-index: -1; } .wishlist-dropdown { max-height: 0; overflow: hidden; width: 100%; box-sizing: border-box; transition: max-height 0.3s ease-in; background-color: #FFF; } .wishlists { padding-top: 10px; overflow: auto; } .wishlist { position: relative; padding: 10px 0 10px 20px; } .wishlist:hover { background-color: #EEE; cursor: pointer; } .wishlist .icon { position: absolute; right: 8px; top: 7px; } .icon-arrow_down-active { position: absolute; right: 10px; top: 17px; } .icon-arrow_down-active:hover { cursor: pointer; } .icon-arrow_down-active:hover ~ .wishlist-button { background-color: #EEE; } .icon-arrow_down-active:active ~ .wishlist-button { background-color: #EEE; box-shadow: inset 0px 0px 8px 0px #999999; } .create-new .text{ padding: 15px 20px; } .create-new .link{ color: #999; border-bottom: 1px solid #999; cursor: pointer; } .create-new .form { display: none; padding-top: 10px; } .create-new input-text, .create-new .submit { float: left; } .create-new input-text { width: 65%; } .create-new .submit { padding: 21px 12px; width: 35%; box-sizing: border-box; border-radius: 0 0 3px 0; border-bottom: none; border-right: none; } .create-new .form input-text{ border-width: 1px 0 0 0; } :host.dropdown-open .wishlist-button { border-radius: 3px 3px 0 0; } :host.dropdown-open .wishlist-dropdown { max-height: 1550px; border: 1px solid #CCCCCC; border-top: none; border-radius: 0 0 3px 3px; } :host.loading loading-spinner { opacity: 1; z-index: 1; } :host.loading .wishlist-button .add-to-text, :host.loading .icon-arrow_down-active{ opacity: 0; } :host.success .successful-text { opacity: 1; } :host.success .wishlist-button .add-to-text, :host.success .icon-arrow_down-active{ opacity: 0; } :host.form-open .create-new .text { display: none; } :host.form-open .create-new .form { display: block; } @media (min-width: 951px) { .wishlist-dropdown { position: absolute; z-index: 1; } .wishlists { max-height: 200px; } :host.dropdown-open .wishlist-dropdown { max-height: 279px; } } @media (min-width: 1081px) { .icon-arrow_down-active ~ .wishlist-button { padding-right: 37px; } } </style><template><template is="dom-if" if="{{wishlists.length}}"><div class="icon icon-arrow_down-active" on-click="_clickButton"></div></template><div class="wishlist-button secondary-button-large-wide" on-click="_clickButton"><span class="add-to-text">{{_translate(copy, 'addToWishlist')}}</span><span class="successful-text">{{_translate(copy, 'successful')}}</span><loading-spinner></loading-spinner></div><template is="dom-if" if="{{wishlists.length}}"><div class="wishlist-dropdown"><div class="wishlists"><template is="dom-repeat" items="{{wishlists}}"><div class="wishlist" id="{{item.id}}" on-click="_clickWishlist"><template is="dom-if" if="{{!item.shared}}"><div class="icon icon-lock"></div></template><span>{{item.name}}</span></div></template></div><div class="create-new"><div class="text">{{_translate(copy, 'or')}}<span class="link" on-click="_openListForm">{{_translate(copy, 'createList')}}</span></div><div class="form"><input-text label="{{_translate(copy, 'listName')}}" type="text" error="" required=""></input-text><input type="button" on-click="_createNewList" class="primary-button-large submit" value="{{_translate(copy, 'create')}}" disabled="disabled"></div></div></div></template></template><script>Polymer({is:"nap-wishlist-button",properties:{wishlists:{type:Array,value:[]},sku:{type:Object,value:{}},copy:{type:Object,value:{en:{addToWishlist:"Add To Wish List",successful:"successfully added",or:"Or ",createList:"Create a new list",create:"Create",listName:"List name"},de:{addToWishlist:"Auf meine Wunschliste",successful:"Erfolgreich hinzugefügt",or:"Oder ",createList:"Neue Liste erstellen",create:"Erstellen",listName:"Name der Liste"},fr:{addToWishlist:"Ajouter à ma wish list",successful:"Ajouté avec succès",or:"Ou ",createList:"Créez une nouvelle liste",create:"Créer",listName:"Nom de la liste"},zh:{addToWishlist:"加入愿望清单",successful:"成功加入愿望清单",or:"或",createList:"创建新的愿望清单",create:"确定",listName:"清单名称"}}}},_clickButton:function(){if(this.wishlists.length===0){this._sendToSignIn()}else{this._toggleDropdown()}},_sendToSignIn:function(){var skuId=this.sku.id||"";window.location.href="https://"+window.location.host+"/"+NAP.locale.channel+"/signin.nap?redirect="+encodeURIComponent(window.location.pathname+"?addToWishlist="+encodeURIComponent(skuId)+"&httpsRedirect=true")},_toggleDropdown:function(){if(!this.classList.contains("success")&&!this.classList.contains("loading")){this.classList.toggle("dropdown-open")}},_clickWishlist:function(event){var target=event.target;while(!target.classList.contains("wishlist")){target=target.parentElement}this._addItem(target.id)},_addItem:function(wishlistId){var self=this;if(this.sku.id){NAP.apiTools.wishlist.addItem(wishlistId,function(data){self.classList.remove("loading");self.classList.add("success");setTimeout(function(){self.classList.remove("success")},3e3);self._sendWishlistAnalytics([{id:self.sku.id,size:self.sku.size}])},{data:{"@type":"/api/schemas/wishlist-item",skuId:this.sku.id},errorHandler:function(){if(self.onError){self.onError()}self.classList.remove("loading")}});this.classList.toggle("dropdown-open");this.classList.add("loading")}else{if(this.invalidSkuCallback){this.invalidSkuCallback()}this._sendWishlistErrorAnalytics()}},_openListForm:function(){var submitButton=this.querySelector(".submit");this.classList.add("form-open");this.querySelector("input-text").addEventListener("input",function(){if(this.isValid()){submitButton.removeAttribute("disabled")}else{submitButton.setAttribute("disabled","disabled")}})},_createNewList:function(){var self=this;var name=this.querySelector("input-text").getValue();if(this.sku.id){NAP.apiTools.wishlist.createList(function(data){self._addItem(data.id);setTimeout(function(){self.push("wishlists",data);self.classList.remove("form-open")},500)},{data:{"@type":"/api/schemas/wishlist",name:name},errorHandler:function(){if(self.onError){self.onError()}self.classList.toggle("dropdown-open");self.classList.remove("form-open")}})}else{if(this.invalidSkuCallback){this.invalidSkuCallback()}}},_translate:function(copy,key){return copy[NAP.locale.language][key]},_sendWishlistAnalytics:function(skuArray){NAP.webAnalytics.api.trackEvent("add to wishlist","update wishlist","ecommerce","product page",{pageNum:"all"},NAP.webAnalytics.getProductsWithSkuData(skuArray))},_sendWishlistErrorAnalytics:function(){NAP.webAnalytics.api.trackEvent("error - cannot add to wishlist - size not selected","user experienced error","error","product page",{errorDetails:"cannot add to wishlist - size not selected"},NAP.webAnalytics.getProducts())}});</script></dom-module><dom-module id="nap-video"><style> :host { display: inline-block; } :host #video { width: 100%; height:auto; } :host #video-container { position: relative; } :host #video-controls { position: absolute; bottom: 2px; width:100%; } :host button { position: absolute; background-color: transparent; outline:none; } :host button:hover { cursor: pointer; } :host button.play { opacity: 0; bottom: 40px; left: 0; right: 0; margin: 0 auto; transition: opacity 0.2s ease-in; transition-delay: 1s; } :host button.close { top: 8px; right: 8px; padding: 12px; } :host:hover button.play { opacity:0.8; transition-delay: 0s; } :host .seekbar { position: absolute; bottom: 0; height: 5px; background-color: #000; outline: none; transition: width 0.5s linear; } :host #seekbarFull { width: 100%; opacity: 0.2; z-index: 2; border:none; -webkit-appearance: none; -moz-appearance: none; }; :host #seekbarFull::-webkit-slider-thumb { -webkit-appearance: none; width:1px; } :host #seekbarFull::-moz-range-thumb { opacity: 0; } :host #seekbarProgress { width: 0; z-index: 1; }; :host #seekbarBuffered { width: 0; opacity: 0.3; z-index: 0; }; </style><template><div id="video-container"><video id="video" on-click="_playPause" muted$="{{muted}}"><content select="source"></content></video><template is="dom-if" if="{{close}}"><button id="close" type="button" class="close" on-click="_close"><div class="icon-cross_black" aria-label="Close"></div></button></template><div id="video-controls"><button type="button" id="playpause" class="play icon-video_play" on-click="_playPause" aria-label="Play"></button><input type="range" id="seekbarFull" class="seekbar" value="0"><div id="seekbarProgress" class="seekbar"></div><div id="seekbarBuffered" class="seekbar"></div></div></div></template><script>Polymer({is:"nap-video",properties:{close:Boolean,name:{type:String,value:"html5 video"},type:{type:String,value:"default"}},_playPause:function(event){if(this.video.paused==true){this.play()}else{this.pause()}},pause:function(){this.video.pause();this.$.playpause.setAttribute("aria-label","Play");this.$.playpause.classList.remove("icon-video_pause");this.$.playpause.classList.add("icon-video_play")},play:function(){this.video.play();this.$.playpause.setAttribute("aria-label","Pause");this.$.playpause.classList.remove("icon-video_play");this.$.playpause.classList.add("icon-video_pause")},reset:function(){video.currentTime=0},_close:function(){this.reset();this.pause();this.fire("close")},ready:function(){var self=this;var video=this.video=this.$.video;var seekBarFull=this.$.seekbarFull;var seekBarProgress=this.$.seekbarProgress;var seekBarBuffered=this.$.seekbarBuffered;video.onended=function(){self.fire("ended")};video.addEventListener("webkitendfullscreen",video.onended);seekBarFull.addEventListener("change",function(){var time=video.duration*(seekBarFull.value/100);video.currentTime=time});video.addEventListener("progress",function(e){var percentageBuffered=(video.buffered.end(0)-video.buffered.start(0))/video.duration*100;seekBarBuffered.style.width=percentageBuffered+"%"});video.addEventListener("timeupdate",function(){var value=(video.currentTime/video.duration*100).toFixed(2);seekBarProgress.style.width=value+"%"});NAP.webAnalytics.api.addPageVideo({videoName:this.name,videoType:this.type,videoPlayer:"html5"})}});</script></dom-module><dom-module id="nap-add-to-bag-button"><style> #buttonel { text-align: center; margin-top: 25px; } #buttonel:focus { outline-style: none; } loading-spinner { display: none; height: 100%; } #buttonlabel { white-space: nowrap; } .loading #buttonlabel { display: none; } .loading loading-spinner { display: inline-block; }	</style><template><button id="buttonel" class="add-to-bag-button " on-click="_addToBag"><span id="buttonlabel">{{_translate(copy, "addToBag")}}</span><loading-spinner id="buttonspinner"></loading-spinner></button></template><script>Polymer({is:"nap-add-to-bag-button",properties:{working:{type:Boolean,value:false},skus:{type:Array,value:[]},copy:{type:Object,value:{en:{addToBag:"Add to bag"},fr:{addToBag:"Ajouter au panier"},de:{addToBag:"In den Warenkorb"},zh:{addToBag:"加入购物袋"}}},buttontype:{type:String,value:"secondary-button-medium"}},ready:function(){this.$.buttonel.classList.add(this.buttontype)},_resetButton:function(){this.$.buttonel.classList.remove("loading");this.working=false},_addToBag:function(){if(this.working){return}if(this.skus){this.working=true;var that=this;this._fixButtonSize();this.$.buttonel.classList.add("loading");var requestTimeout=setTimeout(function(){if(that.working){that._resetButton();window.location.reload()}},1e4);NAP.apiTools.addSkusToBasket(this.skus,function(data){clearTimeout(requestTimeout);that._resetButton();if(data.results&&data.results.length>0&&data.results[0].result==="PRODUCT_ADDED"){var itemPid=data.results[0].sku.split("-");var addEvent=document.createEvent("CustomEvent");addEvent.initCustomEvent("addToBagSuccess",false,false,{pid:itemPid[0]});window.dispatchEvent(addEvent);NAP.headerOverlay.displayProductAlertOverlay("shopping-basket-notify",that.skus.length)}})}},_fixButtonSize:function(){var buttonWidth=this.$.buttonel.offsetWidth;var buttonHeight=this.$.buttonel.offsetHeight;this.$.buttonel.style.height=buttonHeight+"px";this.$.buttonel.style.width=buttonWidth+"px"},_translate:function(copy,key){return copy[NAP.locale.language][key]}});</script></dom-module><dom-module id="nap-product-upsell"><style> :host { overflow:hidden; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; -o-user-select: none; user-select: none; } .swiper-prev, .swiper-next { display: none; } @media (min-width: 951px) { .row { -webkit-flex-wrap: inherit; -ms-flex-wrap: inherit; flex-wrap: inherit; } .swiper-prev, .swiper-next { display: block; position: absolute; z-index: 2; top: calc(50% - 90px); cursor: pointer; } .swiper-next { right: 0; } } </style><template><iron-ajax id="getSummaries" auto="" url="//api.net-a-porter.com/product/summaries/data" params="{{_generateParams(pids, limit)}}" handle-as="json" last-response="{{productSummariesApiResponse}}" last-error="{{productSummariesApiError}}" on-request="_onRequest" on-response="_onResponse" on-error="_onError"></iron-ajax><template is="dom-if" if="{{_carouselNeeded(carousel, pids)}}"><div id="upsell-carousel" class="swiper-container"><div class="icon icon-arrow_left swiper-prev"></div><div class="swiper-wrapper row"><template is="dom-repeat" items$="{{productData}}"><nap-product class="col-xs-6 col-sm-4 col-lg-2 swiper-slide" product="{{item}}" itemprop$="{{schemaproperty}}"></nap-product></template></div><div class="icon icon-arrow_right swiper-next"></div></div></template><template is="dom-if" if="{{!_carouselNeeded(carousel, pids)}}"><template is="dom-repeat" items="{{productData}}"><nap-product class="col-xs-6 col-sm-4 col-lg-2" product="{{item}}" itemprop$="{{schemaproperty}}" itemscope="" itemtype="http://schema.org/Product"></nap-product></template></template></template><script>Polymer({is:"nap-product-upsell",properties:{pids:{type:Array,value:[]},productData:Array,limit:{type:Number,value:6},carousel:{type:Boolean,value:false},carouselInstance:Object,schemaproperty:String},_onRequest:function(){NAP.monitoring.registerPerfMark(this.$.getSummaries.url)},_onResponse:function(){this.productData=this.productSummariesApiResponse;if(this.carousel&&this.pids.length>6){var self=this;var carousel=this.$$("#upsell-carousel");carousel.addEventListener("dom-change",function handler(){carousel.removeEventListener("dom-change",handler);self._initCarousel()})}NAP.monitoring.measurePerfMark("Polymer",this.$.getSummaries.url,{status:"success"})},_onError:function(){NAP.monitoring.registerPerfMetricAndMonitoring("Polymer","API Failure",this.$.getSummaries.url,{status:"error",errorThrown:this.productSummariesApiError.error.message})},_generateParams:function(pids,limit){var uniquePids=pids.filter(function(item,pos,self){return self.indexOf(item)===pos});return{business:"NAP",country:NAP.locale.country,lang:NAP.locale.language,limit:limit,offset:0,pids:uniquePids,sort:"input"}},_carouselNeeded:function(carousel,pids){return this.carousel&&this.pids.length>6},_initCarousel:function(){if(window.innerWidth>=951){if(!this.carouselInstance){var self=this;this.carouselInstance=new Swiper(this.$$("#upsell-carousel"),{loop:true,nextButton:this.$$(".swiper-next"),prevButton:this.$$(".swiper-prev"),slidesPerView:6,simulateTouch:false});var dupes=this.querySelectorAll("nap-product.swiper-slide-duplicate");[].forEach.call(dupes,function(dupedProduct){var index=dupedProduct.getAttribute("data-swiper-slide-index");var realProduct=self.querySelector('nap-product[data-swiper-slide-index="'+index+'"]:not(.swiper-slide-duplicate)');dupedProduct.product=realProduct.product})}}else{if(this.carouselInstance){this.carouselInstance.destroy(true,true);this.carouselInstance=null}}},attached:function(){if(this.carousel&&this.pids.length>6){var orientation;var self=this;window.addEventListener("resize",function(){self._initCarousel()});window.addEventListener("deviceorientation",function(){switch(true){case NAP.device.portrait()&&orientation==="landscape":orientation="portrait";self._initCarousel();break;case NAP.device.landscape()&&orientation==="portrait":orientation="landscape";self._initCarousel();break}})}}});</script></dom-module><dom-module id="nap-shoppable-upsell"><style> :host { overflow:hidden; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; -o-user-select: none; user-select: none; } :host.row { margin-right: 10px; margin-left: 10px; } :host .row, :host .swiper-wrapper { margin: 0 auto; } nap-product { margin-bottom: 25px; } .swiper-prev, .swiper-next { display: none; } @media (max-width: 479px) { :host nap-product { margin-bottom: 50px; } } @media (max-width: 950px) { nap-product:nth-child(n+7) { display: none; } } @media (min-width: 951px) { .row { -webkit-flex-wrap: inherit; -ms-flex-wrap: inherit; flex-wrap: inherit; } .swiper-prev, .swiper-next { display: block; position: absolute; z-index: 2; top: calc(50% - 90px); cursor: pointer; } .swiper-next { right: 0; } nap-product:nth-child(n+7) { display: flex; } } </style><template><template is="dom-if" if="{{_carouselNeeded(carousel, items)}}"><div id="upsell-carousel" class="swiper-container"><div class="icon icon-arrow_left swiper-prev"></div><div class="swiper-wrapper row"><template is="dom-repeat" items$="{{items}}"><nap-product class="col-xs-6 col-sm-4 col-lg-2 swiper-slide" product="{{item}}" itemprop$="{{schemaproperty}}"></nap-product></template></div><div class="icon icon-arrow_right swiper-next"></div></div></template><template is="dom-if" if="{{!_carouselNeeded(carousel, items)}}"><template is="dom-repeat" items="{{items}}"><nap-product class="col-xs-6 col-sm-4 col-lg-2" product="{{item}}" itemprop$="{{schemaproperty}}" itemscope="" itemtype="http://schema.org/Product"></nap-product></template></template></template><script>Polymer({is:"nap-shoppable-upsell",properties:{items:{type:Array,value:[]},limit:{type:Number,value:6},carousel:{type:Boolean,value:false},carouselInstance:Object,schemaproperty:String},_carouselNeeded:function(carousel,items){return this.carousel&&items.length>6},_initCarousel:function(){var that=this;if(window.innerWidth>=951){if(typeof Swiper==="undefined"){return setTimeout(function(){that._initCarousel()},100)}if(!this.carouselInstance){this.carouselInstance=new Swiper(this.$$("#upsell-carousel"),{loop:true,nextButton:this.$$(".swiper-next"),prevButton:this.$$(".swiper-prev"),slidesPerView:6,simulateTouch:false});var dupes=this.querySelectorAll("nap-product.swiper-slide-duplicate");[].forEach.call(dupes,function(dupedProduct){var index=dupedProduct.getAttribute("data-swiper-slide-index");var realProduct=that.querySelector('nap-product[data-swiper-slide-index="'+index+'"]:not(.swiper-slide-duplicate)');dupedProduct.product=realProduct.product})}}else{if(this.carouselInstance){this.carouselInstance.destroy(true,true);this.carouselInstance=null}}},attached:function(){if(this.carousel&&this.items.length>6){var orientation;var self=this;window.addEventListener("resize",function(){self._initCarousel()});window.addEventListener("deviceorientation",function(){switch(true){case NAP.device.portrait()&&orientation==="landscape":orientation="portrait";self._initCarousel();break;case NAP.device.landscape()&&orientation==="portrait":orientation="landscape";self._initCarousel();break}});self._initCarousel()}}});</script></dom-module><dom-module id="nap-ymal-module"><style> :host { display: none; } .heading { text-transform: uppercase; } nap-product-upsell { margin: 0 10px; } @media all and (min-width: 481px) { nap-product-upsell { width: 82%; margin: 0 auto; } } @media all and (min-width: 951px) { nap-product-upsell { width: 100%; max-width: 1080px; } } </style><template><iron-ajax id="getYmal" auto="" url="{{_ymalUrl(pid)}}" handle-as="json" last-response="{{ymalApiResponse}}" last-error="{{ymalApiError}}" on-request="_onRequest" on-response="_onResponse" on-error="_onError"></iron-ajax><widget-show-hide class="open-lg" name="You May Also Like" open="{{open}}"><div class="show-hide-title heading">{{heading}}</div><div class="show-hide-content"><template is="dom-if" if="{{_pidsExist(ymalApiResponse)}}"><nap-product-upsell id="upsell" class="row center-lg" pids="{{ymalApiResponse.ymalPids}}" limit="{{limit}}" schemaproperty="isSimilarTo"></nap-product-upsell><content select=".view-more"></content></template></div></widget-show-hide></template><script>Polymer({is:"nap-ymal-module",properties:{pid:String,heading:String,limit:Number,open:{type:Boolean,value:false},channelIds:{type:Object,value:{intl:1,am:2,apac:9}}},_onRequest:function(){NAP.monitoring.registerPerfMark(this.$.getYmal.url)},_onResponse:function(){if(this._pidsExist(this.ymalApiResponse)){this.style.display="block"}NAP.monitoring.measurePerfMark("Polymer",this.$.getYmal.url,{status:"success"})},_onError:function(){NAP.monitoring.registerPerfMetricAndMonitoring("Polymer","API Failure",this.$.getYmal.url,{status:"error",errorThrown:this.ymalApiError.error.message})},_ymalUrl:function(pid){return"/api/styling/products/"+pid+"/"+this.channelIds[NAP.locale.channel]+"/ymal.json"},_pidsExist:function(data){return data&&data.ymalPids.length>0},getName:function(){return"You May Also Like"},ready:function(){NAP.webAnalytics.api.addPageFeature("ymal")}});</script></dom-module><dom-module id="nap-htwi-module"><style> :host { display: none; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; -o-user-select: none; user-select: none; } .heading { text-transform: uppercase; } nap-product-upsell { margin: 0 10px; } nap-product-upsell.multiple-outfits { visibility: hidden; height: 0px; } nap-product-upsell.visible { visibility: visible; height: auto; } .outfit-images { padding-bottom: 40px; max-width: 1080px; } .outfit-swiper-prev, .outfit-swiper-next { display: block; position: absolute; z-index: 2; top: calc(50% - 45px); cursor: pointer; } .outfit-swiper-next { right: 0; } .outfit-image-wrapper { width: 45%; font-size: 0; display: inline-block; position: relative; } .outfit-image { width: 100%; } .outfit-image-wrapper .arrow { display: none; } .outfit-image-wrapper.selected { border-width: 0 0 4px 0; border-style: solid; border-color: transparent transparent #000 transparent; padding-bottom: 10px; } .outfit-image-wrapper.selected .arrow { display: block; top: 100%; left: 50%; border: solid transparent; content: " "; height: 0; width: 0; position: absolute; pointer-events: none; border-color: rgba(0, 0, 0, 0); border-top-color: #000; border-width: 13px; margin-left: -13px; } @media all and (min-width: 481px) { nap-product-upsell { width: 82%; margin: 0 auto; } } @media all and (min-width: 951px) { nap-product-upsell { width: 100%; max-width: 1080px; } .swiper-wrapper { display: inline-block; text-align: center; font-size: 0; } .outfit-image-wrapper { width: calc(25% - 4px); margin: 0 2px; cursor: pointer; } .outfit-swiper-prev, .outfit-swiper-next { display: none; } } </style><template><iron-ajax id="getHtwi" auto="" url="{{_htwiUrl(pid)}}" handle-as="json" last-response="{{htwiApiResponse}}" last-error="{{htwiApiError}}" on-request="_onRequest" on-response="_onResponse" on-error="_onError"></iron-ajax><widget-show-hide class="open-lg" name="How To Wear It"><div class="show-hide-title heading">{{heading}}</div><div class="show-hide-content"><template is="dom-if" if="{{_multipleOutfits(htwiApiResponse.outfits)}}"><div class="outfit-images swiper-container" id="outfit-carousel"><div class="icon-carousel_arrow-left outfit-swiper-prev"></div><div class="swiper-wrapper outfit-wrapper"><template is="dom-repeat" items="{{outfits}}"><div class="swiper-slide outfit-image-wrapper" data-index$="{{index}}" on-click="_handleOutfitClick"><img src="{{_outfitImageUrl(item.photoPid, item.photoView)}}" class="outfit-image"><div class="arrow"></div></div></template></div><div class="icon-carousel_arrow-right outfit-swiper-next"></div></div><template is="dom-repeat" items="{{outfits}}"><nap-product-upsell class="row center-lg multiple-outfits" pids="{{_getOutfitPids(item)}}" limit="{{item.products.length}}" carousel="" data-index$="{{index}}" schemaproperty="isRelatedTo"></nap-product-upsell></template></template><template is="dom-if" if="{{_oneOutfit(htwiApiResponse.outfits)}}"><nap-product-upsell id="upsell" class="row center-lg" pids="{{_getOutfitPids(htwiApiResponse.outfits.0)}}" limit="{{htwiApiResponse.outfits.0.products.length}}" carousel="" schemaproperty="isRelatedTo"></nap-product-upsell></template></div></widget-show-hide></template><script>Polymer({is:"nap-htwi-module",properties:{pid:String,heading:String,outfits:Array,channelIds:{type:Object,value:{intl:1,am:2,apac:9}},carouselInstance:Object},_onRequest:function(){NAP.monitoring.registerPerfMark(this.$.getHtwi.url)},_onResponse:function(){if(this._outfitsExist(this.htwiApiResponse.outfits)){if(this._multipleOutfits(this.htwiApiResponse.outfits)){var self=this;this.addEventListener("dom-change",function handler(){var upsell=self.querySelector('nap-product-upsell[data-index="0"]');var firstOutfit=self.querySelector(".outfit-image-wrapper");if(upsell&&firstOutfit){upsell.classList.add("visible");firstOutfit.classList.add("selected");if(self.carouselInstance||window.innerWidth>=951){self.removeEventListener("dom-change",handler)}self._initCarousel()}})}this.outfits=this._trimOutfits(this.htwiApiResponse.outfits);this.style.display="block"}NAP.monitoring.measurePerfMark("Polymer",this.$.getHtwi.url,{status:"success"})},_onError:function(){NAP.monitoring.registerPerfMetricAndMonitoring("Polymer","API Failure",this.$.getHtwi.url,{status:"error",errorThrown:this.htwiApiError.error.message})},_trimOutfits:function(outfits){if(outfits.length>4){return outfits.splice(0,4)}return outfits},_htwiUrl:function(pid){return"/api/styling/products/"+pid+"/"+this.channelIds[NAP.locale.channel]+"/outfits.json"},_outfitImageUrl:function(pid,shot){return"//cache.net-a-porter.com/images/products/"+pid+"/"+pid+"_"+shot+"_pp.jpg"},_getOutfitPids:function(outfit){var validProducts=outfit.products.filter(function(product){return product.slotQueue.length>0});return validProducts.map(function(product){return product.slotQueue[0]})},_outfitsExist:function(outfits){return outfits.length>0},_multipleOutfits:function(outfits){return outfits.length>1},_oneOutfit:function(outfits){return outfits.length===1},_carouselNeeded:function(outfit){return outfit.products.length>6},_updateOutfitAndUpsells:function(newOutfit){var napProductUpsells=this.querySelectorAll("nap-product-upsell");[].forEach.call(napProductUpsells,function(upsell){upsell.classList.remove("visible")});var outfitImages=this.querySelectorAll(".outfit-image-wrapper");[].forEach.call(outfitImages,function(outfit){outfit.classList.remove("selected")});newOutfit.classList.add("selected");var index=newOutfit.getAttribute("data-index");var newUpsell=this.querySelector('nap-product-upsell[data-index="'+index+'"]');if(newUpsell){newUpsell.classList.add("visible")}},_handleOutfitClick:function(event){if(window.innerWidth>=951){this._updateOutfitAndUpsells(event.target.parentNode)}},_initCarousel:function(){if(window.innerWidth<951){if(!this.carouselInstance){if(this.$$("#outfit-carousel")){var self=this;var carousel=new Swiper(this.$$("#outfit-carousel"),{loop:true,nextButton:".outfit-swiper-next",prevButton:".outfit-swiper-prev",slidesPerView:"auto",loopedSlides:this.outfits.length,centeredSlides:true,spaceBetween:4,simulateTouch:false,onSlideChangeStart:function(swiper){var newOutfit=self.querySelector(".outfit-image-wrapper.swiper-slide-active");self._updateOutfitAndUpsells(newOutfit)}});if(carousel.slides.length>0){this.carouselInstance=carousel}}}}else{if(this.carouselInstance){this.carouselInstance.destroy(true,true);this.carouselInstance=null}}},getName:function(){return"How To Wear It"},getOutfitIndex:function(){var activeOutfit=this.querySelector(".outfit-image-wrapper.selected");if(activeOutfit){return activeOutfit.getAttribute("data-index")}else{return"0"}},attached:function(){var orientation;var self=this;window.addEventListener("resize",function(){self._initCarousel()});window.addEventListener("deviceorientation",function(){switch(true){case NAP.device.portrait()&&orientation==="landscape":orientation="portrait";self._initCarousel();break;case NAP.device.landscape()&&orientation==="portrait":orientation="landscape";self._initCarousel();break}});NAP.webAnalytics.api.addPageFeature("htwi")}});</script></dom-module><dom-module id="nap-product-swatch"><style> .product-swatch { display:inline-block; border: 1px solid #FFF; } .current { border-color: #979797 } a { display:block; position:relative; overflow: hidden; margin: 4px; width:36px; height:36px; } img.old { position:absolute; top: -54px; left: -54px; } </style><template><div class$="{{_getContainerClass(product.current)}}"><a href="{{_productUrl(product.id)}}"><img id="swatch-image" width="36" height="36" src="{{_imgUrl(product.id)}}" alt=""></a></div></template><script>Polymer({is:"nap-product-swatch",properties:{product:Object},_getContainerClass:function(currentProduct){if(currentProduct){return"product-swatch current"}else{return"product-swatch"}},_productUrl:function(pid){return"/"+NAP.locale.country.toLowerCase()+"/"+NAP.locale.language+"/product/"+pid},_imgUrl:function(pid){return"//cache.net-a-porter.com/images/products/"+pid+"/"+pid+"_sw.jpg"},ready:function(){this.$["swatch-image"].addEventListener("load",function(){if(this.naturalWidth!==72){this.classList.add("old");this.width=134;this.height=134}})}});</script></dom-module><dom-module id="nap-product-swatch-collector"><style> :host { display: block; min-height: 47px; }; </style><template><iron-ajax id="getSummaries" auto="" url="//api.net-a-porter.com/product/summaries/data" params="{{_generateParams(pids)}}" handle-as="json" last-response="{{productSummariesApiResponse}}" last-error="{{productSummariesApiError}}" on-request="_onRequest" on-response="_onResponse" on-error="_onError"></iron-ajax><template is="dom-if" if="{{availableSwatches}}"><template is="dom-repeat" items="{{availableSwatches}}"><nap-product-swatch product="{{item}}"></nap-product-swatch></template></template></template><script>Polymer({is:"nap-product-swatch-collector",properties:{current:String,pids:Array,availableSwatches:Array},_onRequest:function(){NAP.monitoring.registerPerfMark(this.$.getSummaries.url)},_onResponse:function(){this._getPidsOfVisiableProducts(this.current,this.productSummariesApiResponse);NAP.monitoring.measurePerfMark("Polymer",this.$.getSummaries.url,{status:"success"})},_onError:function(){NAP.monitoring.registerPerfMetricAndMonitoring("Polymer","API Failure",this.$.getSummaries.url,{status:"error",errorThrown:this.productSummariesApiError.error.message})},_getPidsOfVisiableProducts:function(current,summeryData){var availableSwatches=[];summeryData.forEach(function(pid){if(pid.visible){availableSwatches.push({id:pid.id,current:false})}});if(availableSwatches.length>0){availableSwatches.unshift({id:Number(current),current:true})}else{this.style.display="none"}this.availableSwatches=availableSwatches},_generateParams:function(pids){return{business:"NAP",country:NAP.locale.country,lang:NAP.locale.language,pids:pids}}});</script></dom-module></div></body></html>